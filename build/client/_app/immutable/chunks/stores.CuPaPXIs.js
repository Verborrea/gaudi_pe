import{w as g}from"./index.DcCWJLEs.js";const h=(l,c)=>{if(typeof localStorage<"u"){const t=localStorage.getItem(l);return t?JSON.parse(t):c}return c};function v(){const{subscribe:l,set:c,update:t}=g(h("cart-v2",{items:[],quantity:0,subtotal:0,nro_latas:0,showToast:!1}));return typeof localStorage<"u"&&l(o=>{localStorage.setItem("cart-v2",JSON.stringify(o))}),{subscribe:l,addItem:(o,u,i,f)=>t(n=>{const b=u*(1-i),a=n.items.findIndex(d=>d.id===o&&d.t===b);a!==-1?n.items[a].q+=1:n.items.push({id:o,t:b,q:1,m:f,d:!1}),n.subtotal+=b,n.quantity+=1;const I=6,S=.16;if(f==="lata"){if(n.nro_latas+=1,n.nro_latas<I)return n;n.nro_latas=0;let d=n.items.filter(e=>e.m==="lata"),[x,q]=d.reduce((e,s)=>(s.t===u*(1-i)?e[0].push(s):e[1].push(s),e),[[],[]]);for(let e of x){const s=q.findIndex(r=>r.id===e.id);if(s!==-1)q[s].q+=e.q,n.items=n.items.filter(r=>!(r.id===e.id&&r.t===e.t));else{const r=n.items.findIndex(p=>p.id===e.id&&p.t===e.t);n.items.splice(r,1,{id:e.id,t:u*(1-S),q:e.q,m:"lata",d:!0})}}n.subtotal-=I*u*(S-i),n.showToast=!0}return n}),removeItem:(o,u)=>t(i=>{const f=i.items.findIndex(e=>e.id===o);if(f===-1)return i;const n=.16;i.quantity-=1;const{id:b,t:a,q:I,m:S}=i.items[f];if(S!=="lata")return I>1?i.items[f].q-=1:i.items.splice(f,1),i.subtotal-=a,i;const d=i.items.findIndex(e=>e.id===o&&e.d===!1);if(d!==-1){const e=i.items[d];return i.items[d].q>1?i.items[d].q-=1:i.items.splice(d,1),i.nro_latas-=1,i.subtotal-=e.t,i}if(i.nro_latas>0){const e=i.items.findIndex(m=>m.id===o&&m.d===!0),s=i.items[e].t;i.items[e].q>1?i.items[e].q-=1:i.items.splice(e,1);const r=i.items.findIndex(m=>m.d===!1&&m.m==="lata"),p=i.items[r];i.items[r].q>1?i.items[r].q-=1:i.items.splice(r,1);const y=i.items.findIndex(m=>m.id===p.id&&m.d===!0);return y!==-1?i.items[y].q+=1:i.items.push({id:p.id,t:s,q:1,m:"lata",d:!0}),i.nro_latas-=1,i.subtotal-=p.t,i}I>1?i.items[f].q-=1:i.items.splice(f,1);let x=5;const q=a/(1-n)*(1-u);for(let e=0;e<i.items.length&&x>0;e++){const s=i.items[e];if(s.m==="lata"&&s.d===!0){const r=Math.min(x,s.q);s.q===r?i.items.splice(e,1,{id:s.id,t:q,q:s.q,m:"lata",d:!1}):(i.items[e].q-=r,i.items.push({id:s.id,t:q,q:r,m:"lata",d:!1})),x-=r}}return i.subtotal-=6*a,i.subtotal+=5*q,i.nro_latas=5,i}),clear:()=>t(o=>(o.quantity=0,o.items=[],o.nro_latas=0,o.subtotal=0,o.showToast=!1,o)),resetToast:()=>t(o=>(o.showToast=!1,o))}}function _(){const{subscribe:l,set:c,update:t}=g(h("envio",{isSet:!1,price:0,coords:null,dia:"Mi√©rcoles"}));return typeof localStorage<"u"&&l(o=>{localStorage.setItem("envio",JSON.stringify(o))}),{subscribe:l,set:c,update:t}}function w(){const{subscribe:l,set:c,update:t}=g(h("info",{name:"",address:"",phone:"+51 ",email:"",notes:""}));return typeof localStorage<"u"&&l(o=>{localStorage.setItem("info",JSON.stringify(o))}),{subscribe:l,set:c,update:t}}const O=v(),J=_(),N=w();export{O as c,J as e,N as i};
